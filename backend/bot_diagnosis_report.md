# –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å Telegram –±–æ—Ç–æ–º

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ:
1. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞** - —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω, –±–æ—Ç –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ Telegram API
2. **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** - —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, —Ç–∞–±–ª–∏—Ü—ã —Å–æ–∑–¥–∞–Ω—ã
3. **UserService** - —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
4. **–û–±—Ä–∞–±–æ—Ç—á–∏–∫ /start** - –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –∫–æ–º–∞–Ω–¥—É –∏ –≤—ã–∑—ã–≤–∞–µ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
5. **Webhook endpoint** - –ø—Ä–∏–Ω–∏–º–∞–µ—Ç –∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç HTTP –∑–∞–ø—Ä–æ—Å—ã
6. **Middleware** - –ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–Ω–µ–¥—Ä—è–µ—Ç —Å–µ—Å—Å–∏—é –ë–î –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏

### ‚ùå –ö–æ—Ä–µ–Ω—å –ø—Ä–æ–±–ª–µ–º—ã:
**–ë–æ—Ç –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç Telegram!** –≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ webhook –ª–∏–±–æ:
- –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –≤ Telegram Bot API
- URL –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω (ngrok —Ç—É–Ω–Ω–µ–ª—å –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç)
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω–æ –∏–ª–∏ –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

## üîç –î–µ—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–∏–∑

### –¢–µ—Å—Ç—ã –ø–æ–∫–∞–∑–∞–ª–∏:
- –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –±–æ—Ç–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –ë–î –ø—Ä–∏ –≤—ã–∑–æ–≤–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
- –°–æ–æ–±—â–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è (–≤ —Ç–µ—Å—Ç–∞—Ö —Å mock –æ–±—ä–µ–∫—Ç–∞–º–∏)
- Webhook endpoint –æ—Ç–≤–µ—á–∞–µ—Ç –Ω–∞ POST –∑–∞–ø—Ä–æ—Å—ã

### –†–µ–∞–ª—å–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:
–ö–æ–≥–¥–∞ –Ω–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç `/start`, Telegram –ø—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å webhook –Ω–∞ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π URL, –Ω–æ:
1. –ó–∞–ø—Ä–æ—Å –Ω–µ –¥–æ—Ö–æ–¥–∏—Ç –¥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
2. –ò–ª–∏ –¥–æ—Ö–æ–¥–∏—Ç, –Ω–æ Telegram –Ω–µ –ø–æ–ª—É—á–∞–µ—Ç –æ—Ç–≤–µ—Ç
3. –ò–ª–∏ –æ—Ç–≤–µ—Ç –ø—Ä–∏—Ö–æ–¥–∏—Ç —Å –æ—à–∏–±–∫–æ–π

## üõ†Ô∏è –†–µ—à–µ–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

### –®–∞–≥ 1: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É webhook –≤ Telegram
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ç–µ–∫—É—â–∏–π webhook
curl "https://api.telegram.org/bot<YOUR_BOT_TOKEN>/getWebhookInfo"
```

### –®–∞–≥ 2: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å ngrok —Ç—É–Ω–Ω–µ–ª—å
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ ngrok –∑–∞–ø—É—â–µ–Ω
ps aux | grep ngrok

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å URL
curl https://<your-ngrok-url>/health
```

### –®–∞–≥ 3: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å webhook –∑–∞–Ω–æ–≤–æ
```bash
# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–π webhook
curl "https://api.telegram.org/bot<YOUR_BOT_TOKEN>/deleteWebhook"

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –Ω–æ–≤—ã–π
curl "https://api.telegram.org/bot<YOUR_BOT_TOKEN>/setWebhook?url=https://<your-ngrok-url>/webhook"
```

### –®–∞–≥ 4: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞
```bash
# –ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ª–æ–≥–∏ uvicorn
tail -f /path/to/server/logs
```

### –®–∞–≥ 5: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
1. –û—Ç–ø—Ä–∞–≤–∏—Ç—å `/start` –±–æ—Ç—É –≤ Telegram
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ –Ω–∞ –≤—Ö–æ–¥—è—â–∏–π webhook
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

## üìã –ü–ª–∞–Ω –¥–µ–π—Å—Ç–≤–∏–π

1. **–ó–∞–ø—É—Å—Ç–∏—Ç—å ngrok:**
   ```bash
   ngrok http 8000
   ```

2. **–û–±–Ω–æ–≤–∏—Ç—å TELEGRAM_WEBHOOK_URL –≤ .env:**
   ```
   TELEGRAM_WEBHOOK_URL=https://abc123.ngrok.io/webhook
   ```

3. **–ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ:**
   ```bash
   uvicorn app.main:app --reload
   ```

4. **–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å webhook:**
   ```bash
   curl "https://api.telegram.org/bot<TOKEN>/setWebhook?url=https://abc123.ngrok.io/webhook"
   ```

5. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Å —Ä–µ–∞–ª—å–Ω—ã–º Telegram**

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–ö–æ–¥ –±–æ—Ç–∞ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–µ–Ω!** –ü—Ä–æ–±–ª–µ–º–∞ –∏—Å–∫–ª—é—á–∏—Ç–µ–ª—å–Ω–æ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ webhook –∏ —Å–µ—Ç–µ–≤–æ–º –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–∏. –í—Å–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ.
